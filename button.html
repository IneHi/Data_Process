<!DOCTYPE html>
<!--
@File   : button.html
@Author :  ({__email})
@Link   : 
@Date   : 2022/12/30 上午8:24:23
-->
<html>
<head>
<title>0</title>
</head>
<body>
    <button>點擊傳送廣播訊息!</button>
<script>const btn = document.querySelector('button');

    function sendData(data) {
      console.log('Sending data');
    
      const XHR = new XMLHttpRequest();
    
      const urlEncodedDataPairs = [];
    
      // Turn the data object into an array of URL-encoded key/value pairs.
      for (const [name, value] of Object.entries(data)) {
        urlEncodedDataPairs.push(`${encodeURIComponent(name)}=${encodeURIComponent(value)}`);
      }
    
      // Combine the pairs into a single string and replace all %-encoded spaces to
      // the '+' character; matches the behavior of browser form submissions.
      const urlEncodedData = urlEncodedDataPairs.join('&').replace(/%20/g, '+');
    
      // Define what happens on successful data submission
      XHR.addEventListener('load', (event) => {
        alert('Yeah! Data sent and response loaded.');
      });
    
      // Define what happens in case of an error
      XHR.addEventListener('error', (event) => {
        alert('Oops! Something went wrong.');
      });
    
      // Set up our request
      XHR.open('POST', 'https://notify-bot.line.me/oauth/token');
    
      // Add the required HTTP header for form data POST requests
      XHR.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      XHR.setRequestHeader('Authorization', 'Bearer binqBNzRbEGcjTfOh4thL2g15m4DBJccuwAnFKpA3Pa');
    
      // Finally, send our data.
      XHR.send(urlEncodedData);
    }
    
    btn.addEventListener('click', () => {
      sendData({ test: 'ok' });
    })
    </script>
</body>
</html>
